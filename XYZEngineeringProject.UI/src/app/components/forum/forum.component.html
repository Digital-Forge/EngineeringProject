<div class="container-fluid my-5" *ngIf="isAuthorized; else notAuthorized">
    <div class="row mb-5">
            <h1 class="col-12 col-md-9 text-center text-md-start">
                {{ 'Forum.messages' | translate }}
            </h1>
        <div class="col-12 col-lg-3 d-flex justify-content-center justify-content-md-end">
            <button class="btn btn-md btn-primary py-auto" (click)="reload()">                
                <i class="bi bi-arrow-repeat me-2"></i>{{ 'Button.refresh' | translate }}
            </button>
        </div>
    </div>
   
    <!--  ps-3 pe-5 -->
    <div class="row border-panels mx-1">
        <!-- mb-3 mb-md-0 p-2 p-md-0 pt-md-2 -->
        <div class="col-12 col-md-2 p-0 border-panel-left bg-light">
            <div class="border-bottom p-2">
                <!--  mx-md-3 -->
                <h4 class="d-inline d-md-block text-break">{{ 'Forum.forums' | translate }}</h4>
            </div>
            <!-- pt-2 pt-md-3 -->
            <div class="border-bottom p-2 cursor-pointer" *ngFor="let forum of forums" (click)="showForum(forum)" [ngClass]="{'fw-bold bg-background': isForumActive(forum)}">
                <!-- mx-md-3 -->
                <p class="d-inline d-md-block  text-break">
                    {{ forum.name | slice: 0:50}}
                    <span *ngIf="forum.name.length > 50">...</span>
                </p>
            </div>
            <div *ngIf="forums.length == 0" class="text-center">
                <p>{{ 'Forum.noForums' | translate }}</p>
            </div>
        </div>
        <!-- p-4 -->
        <div class="col-12 col-md-10 border-panel-right p-3 pb-1" id="messages">
            <div *ngFor="let message of forumMessages; let i=index">
                <div class="row" id="message-{{i}}">
                    <div class="col">
                        <div class="d-inline-block" [ngClass]="{'float-start': !isAuthor(message), 'float-end': isAuthor(message)}">
                            <span class="text-secondary ps-3">{{ message.author }} {{ message.date | dateCustom: 'shortTime'}}</span>
                            <p class="border rounded-pill py-1 px-3" [ngClass]="{'bg-light': !isAuthor(message), 'bg-primary text-light': isAuthor(message)}">
                                {{ message.text }}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div *ngIf="forumMessages.length == 0" class="text-center">
                <p>{{ 'Forum.noMessages' | translate }}</p>
            </div>
        </div>
    </div>
    <div class="row message-form mx-1 mt-3">
        <div class="col col-md-10 offset-md-2">
            <form [formGroup]="messageForm" (ngSubmit)="sendMessageToForum()">
                <div class="row">
                    <div class="col-11">
                        <input type="text" name="message" id="message" formControlName="message" class="form-control" placeholder="{{ 'Forum.typeYourMessage' | translate }}">
                    </div>
                    <div class="col-1 my-auto">
                        <button title="{{ 'Button.sendMessage' | translate }}" class="btn btn-md btn-success" type="submit"><i class="bi bi-send"></i></button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<ng-template #notAuthorized>
    <div class="d-flex justify-content-center">
        <div class="spinner-border" role="status">
            <span class="sr-only"></span>
        </div>
    </div>
</ng-template>