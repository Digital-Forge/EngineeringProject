<div class="container-fluid my-5">
    <div *ngIf="formMode == FormMode.Edit; else header" class="row mb-5 text-center">
        <h1 class="mb-3 col-12">{{ 'User.editUser' | translate }}</h1>
    </div>
    <ng-template #header>
        <div class="row text-center">
            <h1 class="mb-3 col-12">{{ 'User.addUser' | translate }}</h1>
        </div>
    </ng-template>

    <div class="col-8 offset-2 form">
        <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
            <div class="row">
                <div class="mb-3 col-12 col-lg-6">
                    <label class="form-label" for="userUserName">{{ 'User.userName' | translate }}</label>
                    <input class="form-control" type="text" id="userUserName" formControlName="userUserName">
                </div>
                <div class="mb-3 col-12 col-lg-6">
                    <label *ngIf="!userDetails.passwordHash" class="form-label" for="userPassword">{{ 'User.setPassword' | translate }}</label>
                    <label *ngIf="userDetails.passwordHash" class="form-label" for="userPassword">{{ 'User.changePassword' | translate }}</label>
                    <div class="input-group">
                        <input class="form-control" [type]="isPasswordVisible ? 'text' : 'password'" id="userPassword"
                            formControlName="userPassword">
                        <div class="input-group-append cursor-pointer" (click)="togglePasswordVisibility()">
                            <span class="input-group-text" id="password-visibility">
                                <i class="bi" [ngClass]="{ 'bi-eye-slash': isPasswordVisible, 'bi-eye': !isPasswordVisible}"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="mb-3 col-12 col-lg-6">
                    <label class="form-label" for="name">{{ 'User.name' | translate }}</label>
                    <input class="form-control" type="text" id="name" formControlName="name">
                </div>
                <div class="mb-3 col-12 col-lg-6">
                    <label class="form-label" for="surname">{{ 'User.surname' | translate }} *</label>
                    <input class="form-control" type="text" id="surname" formControlName="surname">
                </div>
            </div>
            <div class="row">
                <div class="mb-3 col-12 col-lg-6">
                    <label class="form-label" for="phone">{{ 'User.phone' | translate }}</label>
                    <input class="form-control" type="number" id="phone" formControlName="phone">
                </div>
                <div class="mb-3 col-12 col-lg-6">
                    <label class="form-label" for="pesel">{{ 'User.pesel' | translate }}</label>
                    <input class="form-control" type="number" id="pesel" formControlName="pesel">
                </div>
            </div>

            <h3 class="form-label">{{ 'User.address' | translate }}</h3>
            <div class="row">
                <div class="mb-3 col-12">
                    <label class="form-label" for="addressHome">{{ 'User.homeAddress' | translate }}</label>
                    <input class="form-control" type="text" id="addressHome" formControlName="addressHome">
                </div>
            </div>
            <div class="row">
                <div class="mb-3 col-12">
                    <label class="form-label" for="addressPost">{{ 'User.postAddress' | translate }}</label>
                    <input class="form-control" type="text" id="addressPost" formControlName="addressPost">
                </div>
            </div>

            <h3 class="form-label" *ngIf="formMode==FormMode.Edit">{{'User.roles' | translate}}</h3>
            <ng-container formArrayName="roles" *ngIf="formMode==FormMode.Edit">
                <!-- <div class="row"> -->
                    <table class="table">                                        
                        <thead>
                            <tr>
                                <th class="p-2">{{ 'User.role' | translate }}</th>
                                <th></th>                            
                            </tr>
<<<<<<< HEAD
                        </thead>
                        <tbody>
                        <tr *ngFor="let role of userRoles; let i = index">
                            <!-- <div *ngFor="let role of userRoles; let i = index"> -->
                                    <!-- <ng-container [formGroupName]="i"> -->
                                        <!-- <tr> -->
                            <td>{{ ('Role.' + role) | translate }}</td>
                            <td class="text-end">
                                <!-- <span> -->
                                <button class="btn btn-sm btn-danger-light my-auto" (click)="deleteRole(i)" *ngIf="role.toString()!='EMPLOYEE'">
                                    <i class="bi bi-trash3"></i>
                                </button>
                            <!-- </span> -->
                            </td>
                                        <!-- </tr> -->
                                    <!-- </ng-container> -->
                            <!-- </di> -->
                        </tr>
                        </tbody>
                    </table>
                <!-- </div> -->
            </ng-container>
            <div class="row mb-3" *ngIf="allRoles.length>0">
                <div class="col-12 col-lg-6">
                    <!-- *ngIf="currentUser.role.toString() == 'ADM'; else rolesNoAdmin" -->
                    <select formControlName="newRole" id="newRole" class="form-select">
                        <option *ngFor="let role of allRoles" >
                            {{ ('Role.' + role.toString()) | translate }}
                        </option>
                    </select>
                    <!-- <ng-container #rolesNoAdmin> -->
                        <!-- <select formControlName="newRole" id="newRole" class="form-select">
                            <option *ngFor="let role of allRolesNoAdmin">
                                {{ ('Role.' + role.toString()) | translate }}
                            </option>
                        </select> -->
                    <!-- </ng-container> -->
                </div>
                <div class="col-12 col-lg-2 text-end mt-3 mt-lg-0 pt-1">
                    <button class="btn btn-sm btn-success-light" (click)="addRole()">{{ 'Button.assignRole' | translate }}</button>
                </div>
                    <!-- <div *ngFor="let role of userRoles; let i = index">
                                <tr>
                                    <td>{{role}}</td>
                                    <td><button (click)="deleteRole(i)" *ngIf="role.toString()!='EMPLOYEE'">DeleteRole</button></td>
                                </tr>
                        </div>
                    </table>
                </div>
            <div *ngIf="allRoles.length>0">
                <select formControlName="newRole" id="newRole">
                    <option *ngFor="let role of allRoles">
                        {{role.toString()}}
                    </option>
                </select>
                <button (click)="addRole()">Add Role</button> -->
            </div>

            <div class="row">
                <div class="col text-center text-sm-end">
                    <button type="submit" class="btn btn-primary" [disabled]="!userForm.valid"
                        *ngIf="formMode == FormMode.Edit">{{
                        'Button.save' | translate}}</button>
                    <button type="submit" class="btn btn-primary" [disabled]="!userForm.valid"
                        *ngIf="formMode == FormMode.Add">{{
                        'Button.addUser' | translate}}</button>
                </div>
            </div>
        </form>
    </div>
</div>